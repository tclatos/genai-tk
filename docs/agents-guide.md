# Building Agents with genai-tk: LangChain vs SmolAgents

# WARNING: This file has been generated by an AI and NOT reviewed


A comprehensive guide for creating AI agents using the genai-tk framework with both LangChain and SmolAgents backends.

## Table of Contents

- [Project Overview](#project-overview)
- [Quick Start](#quick-start)
- [LangChain vs SmolAgents](#langchain-vs-smolagents)
- [Configuration Structure](#configuration-structure)
- [Step-by-Step Guide](#step-by-step-guide)
- [Tool Development](#tool-development)
- [Best Practices](#best-practices)
- [Examples](#examples)

## Project Overview

The genai-tk project provides a unified configuration system for building AI agents using either LangChain or SmolAgents frameworks. It abstracts the complexity of agent creation through YAML configurations and provides:

- **Unified tool registry**: Write tools once, use with both frameworks
- **Configuration-driven setup**: YAML-based agent definitions
- **Environment variable expansion**: Secure secrets management
- **CLI interface**: Simple commands to run agents
- **Multiple agent types**: Tool-calling, ReAct, code-execution agents

## Quick Start

### Environment Setup

```bash
# Install the project with uv
uv pip install -e .

# Install required dependencies
uv pip install "pydantic>=2" pydantic-settings pyyaml typer rich
uv pip install langchain langchain-openai "smolagents>=1.0.0" 
uv pip install kuzu duckduckgo-search

# Set up API keys
export OPENAI_API_KEY="your-key-here"
```

### Run Your First Agent

```bash
# LangChain filesystem agent
uv run cli react-agent --config "filesystem" "List Python files in current directory"

# SmolAgents data analysis
uv run cli smolagents --config "Titanic" "What is the survival rate by passenger class?"

# Interactive chat mode
uv run cli react-agent --config "Weather" --chat
```

## LangChain vs SmolAgents

### Comparison Matrix

| Aspect | LangChain | SmolAgents |
|--------|-----------|------------|
| **Footprint** | Rich ecosystem, many integrations | Minimal, lightweight |
| **Philosophy** | Enterprise-ready, production-focused | Fast prototyping, code-centric |
| **Best Use Cases** | Complex workflows, memory, observability | Data analysis, scripting, experiments |
| **Tool System** | StructuredTool with callbacks | Function-based with docstrings |
| **Performance** | Feature-rich, slight overhead | Fewer layers, lower overhead |
| **Learning Curve** | Steeper, more concepts | Simpler mental model |

### When to Choose Each

**Choose LangChain if you need:**
- Multiple tools and complex orchestration
- Memory, streaming, and conversation history
- Production observability and tracing
- Integration with vector databases and enterprise systems
- Advanced patterns like LangGraph workflows

**Choose SmolAgents if you need:**
- Lightweight agents with focused tasks
- Code-executing agents for data wrangling
- Rapid prototyping with minimal boilerplate
- Data science and analysis workflows
- Simple tool integration

## Configuration Structure

### Current YAML Schema

The project uses two main configuration files:

#### LangChain Agents (`config/basic/agents/langchain.yaml`)

```yaml
langchain_agents:
  - name: "agent-name"
    pre_prompt: "System instructions for the agent"
    llm: "model-identifier"  # Optional: specific model
    tools:
      - factory: "module:function"  # Tool factory function
        config_key: value
    mcp_servers:  # Model Context Protocol servers
      - "server-name"
    examples:
      - "Example query 1"
      - "Example query 2"
```

#### SmolAgents (`config/basic/agents/smolagents.yaml`)

```yaml
smolagents_codeact:
  - name: "agent-name"
    tools:
      - class: "module:ClassName"  # Tool class
        name: "tool-instance-name"
        description: "Tool description"
        config_param: value
      - class: "smolagents:BuiltinTool"  # Built-in tools
    authorized_imports: ["pandas", "matplotlib.*", "sklearn.*"]
    pre_prompt: "System instructions"
    examples:
      - "Example usage"
```

## Step-by-Step Guide

### 1. Choose Your Framework

Use this decision tree:

```
Do you need complex multi-step workflows? → LangChain
Do you need memory and conversation history? → LangChain
Do you need production observability? → LangChain
Are you doing data analysis/code execution? → SmolAgents
Do you want minimal dependencies? → SmolAgents
Are you prototyping quickly? → SmolAgents
```

### 2. Create Your Configuration

#### LangChain Example

Add to `config/basic/agents/langchain.yaml`:

```yaml
- name: "Research Assistant"
  pre_prompt: |
    You are a research assistant that can search the web and analyze information.
    Provide comprehensive, well-sourced answers.
  llm: gpt_41mini_openai
  tools:
    - factory: genai_tk.tools.langchain.search_tools_factory:create_search_function
      verbose: true
  mcp_servers:
    - "filesystem"
  examples:
    - "Research the latest developments in quantum computing"
    - "Find information about sustainable energy technologies"
```

#### SmolAgents Example

Add to `config/basic/agents/smolagents.yaml`:

```yaml
- name: "Data Scientist"
  tools:
    - class: genai_tk.tools.smolagents.dataframe_tools:DataFrameTool
      name: "data_analyzer"
      description: "Analyze datasets and generate insights"
    - class: smolagents:WebSearchTool
  authorized_imports: ["pandas", "matplotlib.*", "numpy", "sklearn.*", "seaborn"]
  pre_prompt: |
    You are a professional data scientist. Analyze data thoroughly,
    create visualizations, and provide actionable insights.
  examples:
    - "Load the dataset and show summary statistics"
    - "Create a correlation analysis and visualization"
```

### 3. Run Your Agent

```bash
# LangChain agent
uv run cli react-agent --config "Research Assistant" "What are the latest AI breakthroughs?"

# SmolAgents
uv run cli smolagents --config "Data Scientist" "Analyze this dataset and show key patterns"

# With specific parameters
uv run cli react-agent --config "Weather" --llm gpt_4o_openai "What's the weather in Paris?"
```

### 4. Interactive Mode

```bash
# Start interactive chat
uv run cli react-agent --config "Research Assistant" --chat

# This opens an interactive shell where you can:
# > What are the benefits of renewable energy?
# > Tell me more about solar panel efficiency
# > exit
```

## Tool Development

### Creating Custom Tools

#### For SmolAgents

```python
# genai_tk/tools/smolagents/custom_tools.py
from smolagents import Tool
import requests

class WebScraperTool(Tool):
    """Tool for scraping web content."""
    
    name = "web_scraper"
    description = "Extract content from web pages"
    inputs = {"url": {"type": "string", "description": "URL to scrape"}}
    output_type = "string"
    
    def forward(self, url: str) -> str:
        """Scrape content from a URL.
        
        Args:
            url: The web page URL to scrape
            
        Returns:
            Extracted text content from the page
        """
        response = requests.get(url)
        # Add your scraping logic here
        return response.text[:1000]  # Return first 1000 chars
```

#### For LangChain

```python
# genai_tk/tools/langchain/custom_factory.py
from langchain_core.tools import BaseTool
from typing import List

def create_calculator_tool() -> List[BaseTool]:
    """Create a calculator tool for LangChain agents."""
    
    from langchain_core.tools import StructuredTool
    
    def calculate(expression: str) -> str:
        """Evaluate a mathematical expression.
        
        Args:
            expression: Mathematical expression to evaluate
            
        Returns:
            Result of the calculation
        """
        try:
            result = eval(expression)  # Use safely in production
            return str(result)
        except Exception as e:
            return f"Error: {str(e)}"
    
    return [StructuredTool.from_function(
        func=calculate,
        name="calculator",
        description="Perform mathematical calculations"
    )]
```

### Tool Registration

Add your tools to the configuration:

```yaml
# For LangChain
tools:
  - factory: genai_tk.tools.langchain.custom_factory:create_calculator_tool

# For SmolAgents  
tools:
  - class: genai_tk.tools.smolagents.custom_tools:WebScraperTool
```

## Best Practices

### Configuration Management

```yaml
# ✅ Good: Use environment variables for secrets
llm_config:
  api_key: ${OPENAI_API_KEY}
  base_url: ${OPENAI_BASE_URL}

# ✅ Good: Clear, descriptive names
- name: "Financial Data Analyst"
  description: "Analyzes financial datasets and creates reports"

# ❌ Bad: Hardcoded secrets
api_key: "sk-1234567890abcdef"

# ❌ Bad: Vague names
- name: "Agent1"
```

### Tool Development Guidelines

```python
# ✅ Good: Clear docstrings for SmolAgents
def analyze_sentiment(text: str) -> str:
    """Analyze the sentiment of given text.
    
    Args:
        text: The text to analyze for sentiment
        
    Returns:
        Sentiment classification: positive, negative, or neutral
    """
    
# ✅ Good: Structured output
return json.dumps({
    "sentiment": "positive",
    "confidence": 0.85,
    "keywords": ["good", "excellent", "amazing"]
})

# ❌ Bad: Unclear function signature
def process(data):
    # What does this do? What does it return?
    pass
```

### Agent Design Principles

1. **Keep system prompts concise and task-specific**

```yaml
# ✅ Good
pre_prompt: |
  You are a financial analyst. Focus on data-driven insights 
  and provide specific recommendations based on quantitative analysis.

# ❌ Bad  
pre_prompt: |
  You are a helpful assistant that can do many things including
  financial analysis, general questions, coding help, and more...
```

2. **Restrict tool capabilities to least privilege needed**

```yaml
# ✅ Good: Specific, focused tools
tools:
  - class: genai_tk.tools.smolagents.dataframe_tools:DataFrameTool
    source_path: "./data/financial_data.csv"
    
# ❌ Bad: Overly broad tools
tools:
  - class: FileSystemTool  # Can access entire filesystem
```

3. **Use Kuzu and Cypher for graph data**

```yaml
# ✅ Preferred for graph/relationship data
tools:
  - class: genai_tk.tools.kuzu.CypherTool
    database_path: "./data/knowledge_graph"

# ⚠️ Less optimal for graph queries    
tools:
  - class: SQLTool
    connection_string: "sqlite:///graph.db"
```

### Code Standards

Following the project's coding guidelines:

```python
# ✅ Use Python 3.12+ typing
from typing import Optional, Union

# Modern syntax
def process_data(items: list[str]) -> dict[str, str | None]:
    return {"result": items[0] if items else None}

# ✅ Absolute imports for project modules
from genai_tk.core.llm_factory import LlmFactory
from genai_tk.tools.registry import register_tool

# ✅ Google-style docstrings (no types mentioned)
def load_config(path: str) -> dict:
    """Load configuration from YAML file.
    
    Args:
        path: Path to the configuration file
        
    Returns:
        Parsed configuration dictionary
        
    Example:
        ```python
        config = load_config("config/agent.yaml")
        ```
    """
```

## Examples

### Example 1: Web Research Agent (LangChain)

**Configuration** (`config/basic/agents/langchain.yaml`):
```yaml
- name: "Web Researcher"
  pre_prompt: |
    You are a research assistant that searches the web and synthesizes information.
    Provide comprehensive answers with sources.
  tools:
    - factory: genai_tk.tools.langchain.search_tools_factory:create_search_function
      verbose: true
  examples:
    - "What are the latest developments in renewable energy?"
    - "Research the impact of AI on healthcare"
```

**Usage**:
```bash
uv run cli react-agent --config "Web Researcher" "What are the pros and cons of electric vehicles?"
```

### Example 2: Data Analysis Agent (SmolAgents)

**Configuration** (`config/basic/agents/smolagents.yaml`):
```yaml
- name: "Sales Analyst"
  tools:
    - class: genai_tk.tools.smolagents.dataframe_tools:DataFrameTool
      name: "sales_data"
      description: "Monthly sales data for analysis"
      source_path: "./data/sales_2024.csv"
  authorized_imports: ["pandas", "matplotlib.pyplot", "seaborn", "numpy"]
  pre_prompt: |
    You are a sales data analyst. Create visualizations and provide
    actionable business insights from the data.
  examples:
    - "Show monthly sales trends and identify patterns"
    - "Which products are performing best this quarter?"
```

**Usage**:
```bash
uv run cli smolagents --config "Sales Analyst" "Analyze Q3 sales performance and create a summary report"
```

### Example 3: Hybrid Agent with Multiple Tools

**Configuration** (`config/basic/agents/smolagents.yaml`):
```yaml
- name: "Market Research Analyst"
  tools:
    - class: genai_tk.tools.smolagents.dataframe_tools:DataFrameTool
      name: "market_data"
      description: "Historical market data"
      source_path: "./data/market_data.csv"
    - class: smolagents:WebSearchTool
  authorized_imports: ["pandas", "matplotlib.*", "yfinance", "numpy"]
  pre_prompt: |
    You combine web research with quantitative analysis to provide
    comprehensive market insights.
  examples:
    - "Research Tesla stock and analyze recent performance data"
    - "Compare tech sector trends with historical data"
```

**Usage**:
```bash
uv run cli smolagents --config "Market Research Analyst" "Analyze Apple's stock performance and recent news impact"
```

## Advanced Features

### Deep Agents

For complex, multi-stage tasks:

```bash
# Create a deep agent for comprehensive research
uv run cli deep-agent --config "Research" "Conduct a full analysis of renewable energy adoption trends"

# List available deep agent configurations
uv run cli list-deep-agents
```

### MCP (Model Context Protocol) Integration

LangChain agents can connect to MCP servers:

```bash
# Use filesystem and playwright MCP servers
uv run cli react-agent --mcp filesystem --mcp playwright "Analyze the website content and save to file"
```

### Custom LLM Configuration

```yaml
# Specify custom models
- name: "Premium Research Agent"
  llm: gpt_4o_openai  # Use GPT-4 for complex tasks
  
# Or use model tags  
- name: "Fast Agent"
  llm: fast_model  # Resolves to configured fast model
```

## Troubleshooting

### Common Issues

1. **Missing API Keys**
```bash
# Set required environment variables
export OPENAI_API_KEY="your-key"
export ANTHROPIC_API_KEY="your-key"  # If using Claude
```

2. **Configuration Not Found**
```bash
# List available configurations
uv run cli react-agent --help
uv run cli smolagents --help
```

3. **Tool Import Errors**
```bash
# Ensure all dependencies are installed
uv pip install pandas matplotlib scikit-learn
```

4. **Permission Issues**
```bash
# Check file permissions for data files
chmod 644 ./data/*.csv
```

## Testing Your Agents

### Unit Tests

Create tests for your configurations:

```python
# tests/test_my_agent.py
import pytest
from genai_tk.config.loader import load_runtime_config

def test_agent_config_loads():
    """Test that agent configuration loads correctly."""
    # Test your configurations here
    pass

def test_tool_functionality():
    """Test custom tools work as expected."""
    # Test your custom tools here
    pass
```

Run tests:
```bash
uv run pytest tests/ -v
```

### Integration Tests

Test full agent workflows:

```bash
# Test with sample queries
uv run cli react-agent --config "filesystem" "List files in tests directory"
uv run cli smolagents --config "Titanic" "Show basic statistics"
```

## Contributing

When adding new agents or tools:

1. Follow the project's coding standards (see AGENTS.md)
2. Add comprehensive examples to your configuration
3. Write tests for new functionality
4. Update this documentation

## Additional Resources

- [Project Development Guidelines](./AGENTS.md)
- [Configuration Schema](./config-schema.md)
- [API Reference](./api-reference.md)
- [Tool Development Guide](./tools-guide.md)

---

For questions or contributions, refer to the project's issue tracker and contribution guidelines.